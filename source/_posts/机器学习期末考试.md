---
title: 机器学期期末考试内容
description: 这是用来测试 Hexo + GitHub Actions 自动部署的文章
tags:
  - Hexo
  - GitHub Actions
categories:
  - 机器学习
date: 2025-12-05 15:00:00
---

1. 多重分类

{% codeblock lang:python %}

============================================
1. 问题定义
============================================
目标：预测 Credit_Score（Good / Standard / Poor）
评价指标：f1-macro
============================================
2. 加载库和数据
============================================

import pandas as pd

train = pd.read_csv("https://raw.githubusercontent.com/lovedlim/bigdata_analyst_cert/main/part2/ch7/score_train.csv
")
test = pd.read_csv("https://raw.githubusercontent.com/lovedlim/bigdata_analyst_cert/main/part2/ch7/score_test.csv
")

============================================
3. 探索性数据分析（EDA）
============================================

print("===== 数据大小 =====")
print("Train Shape:", train.shape)
print("Test Shape :", test.shape)

print("===== 数据类型 =====")
print(train.info())

print("===== train 缺失值数量 =====")
print(train.isnull().sum().sum())

print("===== test 缺失值数量 =====")
print(test.isnull().sum().sum())

print("===== Credit_Score 频率 =====")
print(train["Credit_Score"].value_counts())

============================================
4. 数据预处理
============================================

target = train.pop("Credit_Score")

train = pd.get_dummies(train)
test = pd.get_dummies(test)

============================================
5. 拆分验证数据
============================================

from sklearn.model_selection import train_test_split
X_tr, X_val, y_tr, y_val = train_test_split(train, target, test_size=0.2, random_state=0)

print("===== 拆分后的数据大小 =====")
print(X_tr.shape, X_val.shape, y_tr.shape, y_val.shape)

============================================
6. 机器学习训练与评估
============================================

from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import f1_score

rf = RandomForestClassifier(random_state=0)
rf.fit(X_tr, y_tr)
pred = rf.predict(X_val)

print("\n f1-macro:", f1_score(y_val, pred, average="macro"))
{% endcodeblock %}

2. 回归预测

{% codeblock lang:python %}

============================================
1. 问题定义
============================================
目标：预测笔记本电脑价格 Price
指标：R²
============================================
2. 加载数据
============================================

import pandas as pd

train = pd.read_csv("https://raw.githubusercontent.com/lovedlim/bigdata_analyst_cert/main/part2/ch8/laptop_train.csv
")
test = pd.read_csv("https://raw.githubusercontent.com/lovedlim/bigdata_analyst_cert/main/part2/ch8/laptop_test.csv
")

============================================
3. EDA
============================================

print("===== 数据大小 =====")
print(train.shape, test.shape)

print("===== 数据类型 =====")
print(train.info())

print("===== train 缺失值 =====")
print(train.isnull().sum())

print("===== test 缺失值 =====")
print(test.isnull().sum())

print("===== Price 统计 =====")
print(train["Price"].describe())

============================================
4. 数据预处理
============================================

target = train.pop("Price")

c_cols = ["Model","Series","Processor","Processor_Gen","Hard_Disk_Capacity","OS"]
train[c_cols] = train[c_cols].fillna("X")
test[c_cols] = test[c_cols].fillna("X")

train["RAM"] = train["RAM"].fillna(-1)
test["RAM"] = test["RAM"].fillna(-1)

combined = pd.concat([train, test])
combined = pd.get_dummies(combined)

train = combined[:len(train)]
test = combined[len(train):]

============================================
5. 拆分验证数据
============================================

from sklearn.model_selection import train_test_split
X_tr, X_val, y_tr, y_val = train_test_split(train, target, test_size=0.2, random_state=0)

print(X_tr.shape, X_val.shape, y_tr.shape, y_val.shape)

============================================
6. 训练 & 评估
============================================

from sklearn.ensemble import RandomForestRegressor
from sklearn.metrics import r2_score

rf = RandomForestRegressor(random_state=0)
rf.fit(X_tr, y_tr)
pred = rf.predict(X_val)

print("\n R2:", r2_score(y_val, pred))
{% endcodeblock %}

3. 二分类预测

{% codeblock lang:python %}

============================================
1. 问题定义
============================================
目标：预测糖尿病，目标值：Outcome（0/1）
指标：ROC-AUC
============================================
2. 加载数据
============================================

import pandas as pd

train = pd.read_csv("https://raw.githubusercontent.com/lovedlim/bigdata_analyst_cert/main/part2/ch6/diabetes_train.csv
")
test = pd.read_csv("https://raw.githubusercontent.com/lovedlim/bigdata_analyst_cert/main/part2/ch6/diabetes_test.csv
")

============================================
3. EDA
============================================

print(train.shape, test.shape)
print(train.info())
print(train.isnull().sum().sum())
print(test.isnull().sum().sum())
print(train["Outcome"].value_counts())

============================================
4. 数据预处理
============================================

target = train.pop("Outcome")

============================================
5. 拆分验证数据
============================================

from sklearn.model_selection import train_test_split
X_tr, X_val, y_tr, y_val = train_test_split(train, target, test_size=0.2, random_state=0)

print(X_tr.shape, X_val.shape)

============================================
6. 模型训练
============================================

from sklearn.ensemble import RandomForestClassifier

rf = RandomForestClassifier(random_state=0)
rf.fit(X_tr, y_tr)

============================================
7. 生成提交文件
============================================

pred_test = rf.predict_proba(test)

submit = pd.DataFrame({"pred": pred_test[:, 1]})
submit.to_csv("result.csv", index=False)

print(submit.head())
{% endcodeblock %}

4. 11 题小题（全部整理完毕）
第 1 题

{% codeblock lang:python %}
import pandas as pd
df = pd.read_csv("members.csv")
n = int(len(df)*0.8)
df2 = df.iloc[:n]
std_before = df2["f1"].std()
df2["f1"] = df2["f1"].fillna(df2["f1"].mean())
std_after = df2["f1"].std()
print(round(abs(std_before - std_after), 2))
{% endcodeblock %}

第 2 题

{% codeblock lang:python %}
import pandas as pd
df = pd.read_csv("members.csv")
m = df["age"].mean()
s = df["age"].std()
min_v = m - 1.5s
max_v = m + 1.5s
out = df[(df["age"]<min_v) | (df["age"]>max_v)]
print(out["age"].sum())
{% endcodeblock %}

第 3 题

{% codeblock lang:python %}
import pandas as pd
df = pd.read_csv("members.csv").dropna()
n = int(len(df)*0.7)
df2 = df.iloc[:n]
print(int(df2["f1"].quantile(0.25)))
{% endcodeblock %}

第 4 题

{% codeblock lang:python %}
import pandas as pd
df = pd.read_csv("members.csv")
print(df.isnull().sum().idxmax())
{% endcodeblock %}

第 5 题

{% codeblock lang:python %}
import pandas as pd
df = pd.read_csv("data4-1.csv")
q1 = df["age"].quantile(0.25)
q3 = df["age"].quantile(0.75)
print(int(abs(q3 - q1)))
{% endcodeblock %}

第 6 题

{% codeblock lang:python %}
import pandas as pd
df = pd.read_csv("data4-2.csv")
df["rate"] = (df["loves"] + df["wows"]) / df["reactions"]
cond = df[(0.4 <= df["rate"]) & (df["rate"] <= 0.5) & (df["type"]=="video")]
print(len(cond))
{% endcodeblock %}

第 7 题

{% codeblock lang:python %}
import pandas as pd
df = pd.read_csv("data5-2.csv")
df["BMI"] = df["weight"] / (df["height"]/100)**2
normal = df[(18.5 <= df["BMI"]) & (df["BMI"] <= 23)]
danger = df[(df["BMI"] > 23) & (df["BMI"] <= 25)]
print(abs(len(normal) - len(danger)))
{% endcodeblock %}

第 8 题

{% codeblock lang:python %}
import pandas as pd
df = pd.read_csv("student_assessment.csv").dropna()
top = df["code_module"].value_counts().idxmax()
sub = df[df["code_module"]==top]
mean = sub["score"].mean()
std = sub["score"].std()
sub["score_z"] = (sub["score"] - mean) / std
print(round(sub["score_z"].max(), 3))
{% endcodeblock %}

第 9 题

{% codeblock lang:python %}
import pandas as pd
df = pd.read_csv("air_quality.csv")
q1 = df["CO2"].quantile(0.25)
q3 = df["CO2"].quantile(0.75)
iqr = q3 - q1
min_v = q1 - 1.5iqr
max_v = q3 + 1.5iqr
out = df[(df["CO2"]<min_v) | (df["CO2"]>max_v)]
print(len(out))
{% endcodeblock %}

第 10 题

{% codeblock lang:python %}
import pandas as pd
df = pd.read_csv("drinks.csv")
continent_mean = df.groupby("continent")["beer_servings"].mean()
top = continent_mean.idxmax()
sub = df[df["continent"]==top]
sub_sorted = sub.sort_values(by="beer_servings", ascending=False)
print(sub_sorted.iloc[4]["beer_servings"])
{% endcodeblock %}

第 11 题

{% codeblock lang:python %}
import pandas as pd
df = pd.read_csv("chem.csv")

co_min = df["co"].min()
co_max = df["co"].max()
df["co_minmax"] = (df["co"] - co_min) / (co_max - co_min)

nm_min = df["nmhc"].min()
nm_max = df["nmhc"].max()
df["nmhc_minmax"] = (df["nmhc"] - nm_min) / (nm_max - nm_min)

print(round(df["co_minmax"].std() - df["nmhc_minmax"].std(), 3))
{% endcodeblock %}
